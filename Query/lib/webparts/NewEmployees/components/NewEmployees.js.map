{"version":3,"sources":["webparts/NewEmployees/components/NewEmployees.tsx"],"names":[],"mappings":"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","file":"webparts/NewEmployees/components/NewEmployees.js","sourcesContent":["import * as React from 'react';\r\nimport styles from './NewEmployees.module.scss';\r\nimport { IFileUploadProps } from './INewEmployeesProps';\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\nimport { Log, UrlQueryParameterCollection } from '@microsoft/sp-core-library';\r\nimport DropzoneComponent from 'react-dropzone-component';\r\nimport pnp, { Lists, Web } from 'sp-pnp-js';\r\nimport { Dropdown, DropdownMenuItemType, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown'\r\nimport { SPHttpClient, HttpClientResponse, SPHttpClientResponse } from '@microsoft/sp-http';\r\nimport { PrimaryButton } from 'office-ui-fabric-react/lib/Button';\r\nimport {\r\n  Dialog, DialogContent, DialogFooter, DialogType\r\n} from 'office-ui-fabric-react/lib/Dialog';\r\n\r\n\r\n\r\n\r\n\r\nexport default class FileUpload extends React.Component<IFileUploadProps, {}> {\r\n\r\n\r\n\r\n  constructor(props: IFileUploadProps) {\r\n    super(props);\r\n    console.log(\"name\", this.props.context.pageContext.user.loginName);\r\n\r\n\r\n    this.open = this.open.bind(this);\r\n    this.close = this.close.bind(this);\r\n\r\n    this.sendMessage = this.sendMessage.bind(this);\r\n  }\r\n\r\n  sendMessage() {\r\n\r\n\r\n    var bodyElem = document.getElementById('popupMsgContent') as HTMLTextAreaElement;\r\n    var body_ = bodyElem.value;\r\n    if (body_ == \"\") {\r\n      document.getElementById('errorMsg').style.display = \"block\"\r\n      setTimeout(() => document.getElementById('errorMsg').style.display = \"none\", 2000)\r\n    }\r\n    else {\r\n\r\n      var current = this.props.lists\r\n\r\n\r\n      var url = `${this.props.context.pageContext.web.absoluteUrl}/_api/web/lists('` + current + `')/Items`;\r\n\r\n      var myHeaders = {\r\n        'Accept': 'application/json;odata=nometadata',\r\n        'Content-type': 'application/json;odata=verbose',\r\n        'odata-version': ''\r\n      };\r\n      var body:\r\n        string = JSON.stringify({\r\n          '__metadata': {\r\n            'type': 'SP.Data.' + this.props.listName + 'ListItem'\r\n          },\r\n          //\"Title\": title_,\r\n          \"Title\": body_,\r\n        });\r\n      this.props.spHttpClient.post(url,\r\n        SPHttpClient.configurations.v1,\r\n        {\r\n          headers: myHeaders,\r\n          body: body\r\n        })\r\n        .then((response: SPHttpClientResponse) => {\r\n          console.log(\"sendMessage response\", response);\r\n\r\n\r\n\r\n          this.close();\r\n          this.open2();\r\n          setTimeout(() => this.close2(), 3000)\r\n        });\r\n\r\n\r\n\r\n    }\r\n\r\n\r\n  }\r\n\r\n  open() {\r\n    console.log(\"open\", this.state.isOpen);\r\n    this.setState({ isOpen: true });\r\n  }\r\n\r\n  close = () => this.setState({ isOpen: false })\r\n\r\n  open2() {\r\n    this.setState({ isOpenSecond: true });\r\n  }\r\n\r\n  close2 = () => this.setState({ isOpenSecond: false })\r\n  displayForm = () => this.setState({ isOpen: true })\r\n\r\n  state = {\r\n    messages: [],\r\n    isOpen: false,\r\n\r\n    isOpenSecond: false,\r\n\r\n\r\n  }\r\n\r\n\r\n  public render(): React.ReactElement<IFileUploadProps> {\r\n\r\n\r\n    return (\r\n      <div>\r\n        <div className={styles.questionComponent} id=\"questionComponentId\">\r\n          <img style={{ height: `${this.props.iconSize}px` }} src={this.props.icon} alt=\"\" onClick={(e) => this.displayForm()} />\r\n          <button id='questionButton' style={{ color: this.props.linkColor, fontSize: `${this.props.fontSize}px` }} className={styles.LinkButton} onClick={(e) => this.displayForm()}>  {this.props.linkTitle}</button>\r\n\r\n        </div>\r\n        <Dialog\r\n          isOpen={this.state.isOpenSecond}\r\n          type={DialogType.close}\r\n          onDismiss={this.close2}\r\n\r\n          isBlocking={false}\r\n          closeButtonAriaLabel='Close'\r\n\r\n        >\r\n          <DialogContent>\r\n            השאלה נשלחה בהצלחה!\r\n          </DialogContent>\r\n          <DialogFooter>\r\n\r\n          </DialogFooter>\r\n        </Dialog >\r\n        <Dialog\r\n          isOpen={this.state.isOpen}\r\n          type={DialogType.close}\r\n          onDismiss={this.close.bind(this)}\r\n\r\n\r\n          isBlocking={false}\r\n          closeButtonAriaLabel='Close'>\r\n          <div id=\"popupContent \" className='text-center'>\r\n            <div className=\"popUpTitle\" style={{ fontWeight: \"bold\" }}>\r\n\r\n              {this.props.dialogTitle}\r\n\r\n            </div>\r\n            <br></br>\r\n\r\n            <div className=\"\"><label style={{ width: \"10%\" }}>תוכן: </label><br></br><div className=\"popupMsgContent\"><textarea id='popupMsgContent' style={{ width: \"97%\", height: \"100px\", margin: \"7px 0px\" }}></textarea></div>\r\n              <small id=\"errorMsg\" className={styles.error}>יש להזין שאלה</small>\r\n\r\n            </div>\r\n          </div>\r\n          <DialogFooter>\r\n            <PrimaryButton style={{ marginLeft: '28% !important' }} onClick={this.sendMessage}>{\"שלח\"}</PrimaryButton>\r\n          </DialogFooter>\r\n        </Dialog>\r\n\r\n\r\n      </div >\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\..\\src"}